---
title: "Lab 05 - La Quinta is Spanish for next to Denny's, Pt. 2"
author: "Charlize Ezernack"
date: "Insert date here"
output: github_document
---

### Load packages and data

```{r load-packages, message = FALSE}
library(tidyverse) 
library(dsbox) 

```

```{r load-data, message = FALSE}
states <- read_csv("data/states.csv")


```

### Exercise 1

```{r filterdennys}
dn_ak <- dennys %>%
  filter(state == "AK")
nrow(dn_ak)

```

There are 3 Dennys locations in Alaska.

### Exercise 2

```{r filterquinta}
lq_ak <- laquinta %>%
  filter(state == "AK")
nrow(lq_ak)

```

There are 2 La Quinta locations in Alaska.

### Exercise 3

We are looking of 6 pairings of Dennys x La Quinta locations so I will need to calculate 6 distances between locations. 


### Exercise 4

```{r joindata}

dn_lq_ak <- full_join(dn_ak, lq_ak,
  by = "state"
)
dn_lq_ak

```

There are 12 observations in the joined data frame. 

### Exercise 5

We will use the mutate() function to add a new variable into the data frame while keeping the existing variables. 


### Exercise 6
```{r calculatedistance}
haversine <- function(longitude.x, latitude.x, longitude.y, latitude.y, round = 3) {
  

  # convert to radians
  long1 <- longitude.x * pi / 180
  lat1 <- latitude.x * pi / 180
  long2 <- longitude.y * pi / 180
  lat2 <- latitude.y * pi / 180

  R <- 6371 # Earth mean radius in km

  a <- sin((lat2 - lat1) / 2)^2 + cos(lat1) * cos(lat2) * sin((long2 - long1) / 2)^2
  d <- R * 2 * asin(sqrt(a))

  return(round(d, round)) # distance in km
  
} 
dn_lq_ak <- dn_lq_ak %>% mutate(distance = haversine(longitude.x, latitude.x, longitude.y, latitude.y))

```

### Exercise 7

```{r mindennys}
dn_lq_ak <- dn_lq_ak %>% group_by(address.x) %>% mutate(mindistance = min(distance, na.rm = FALSE)) %>% ungroup()

meandennys <- dn_lq_ak %>% 
  summarize(meandennys1 = mean(mindistance, na.rm = TRUE)) 

print(meandennys)

```

### Exercise 8
```{r mindennys}
 dn_lq_ak %>% ggplot(aes( x = mindistance, fill=address.x)) + geom_histogram(binwidth = .5) + labs(title = "Denny's in Alaska", subtitle = "The minimum distance from each Denny's to a La Quinta location")


```

The mean distance of Dennys to the closest La Quinta is 4.41 km in Alaska. 

### Exercise 9
```{r filterNC}
dn_nc <- dennys %>%
  filter(state == "NC")
nrow(dn_nc)

```

```{r filterquintaNC}
lq_nc <- laquinta %>%
  filter(state == "NC")
nrow(lq_nc)

```

```{r joindataNC}

dn_lq_nc <- full_join(dn_nc, lq_nc,
  by = "state"
)
dn_lq_nc

```

```{r calculatedistanceNC}
haversine <- function(longitude.x, latitude.x, longitude.y, latitude.y, round = 3) {
  

  # convert to radians
  long1 <- longitude.x * pi / 180
  lat1 <- latitude.x * pi / 180
  long2 <- longitude.y * pi / 180
  lat2 <- latitude.y * pi / 180

  R <- 6371 # Earth mean radius in km

  a <- sin((lat2 - lat1) / 2)^2 + cos(lat1) * cos(lat2) * sin((long2 - long1) / 2)^2
  d <- R * 2 * asin(sqrt(a))

  return(round(d, round)) # distance in km
  
} 
dn_lq_nc <- dn_lq_nc %>% mutate(distance = haversine(longitude.x, latitude.x, longitude.y, latitude.y))

```

```{r mindennysnc}
dn_lq_nc <- dn_lq_nc %>% group_by(address.x) %>% mutate(mindistance = min(distance, na.rm = FALSE)) %>% ungroup()

meandennys <- dn_lq_nc %>% 
  summarize(meandennys2 = mean(mindistance, na.rm = TRUE)) 

print(meandennys)

```


The mean distance of Dennys to the closest La Quinta is 65.4 km in North Carolina.  


### Exercise 10
```{r filterTX}
dn_tx <- dennys %>%
  filter(state == "TX")
nrow(dn_tx)

```

```{r filterquintaTX}
lq_tx <- laquinta %>%
  filter(state == "TX")
nrow(lq_tx)

```

```{r joindataTX}

dn_lq_tx <- full_join(dn_tx, lq_tx,
  by = "state"
)
dn_lq_tx

```

```{r calculatedistancetx}
haversine <- function(longitude.x, latitude.x, longitude.y, latitude.y, round = 3) {
  

  # convert to radians
  long1 <- longitude.x * pi / 180
  lat1 <- latitude.x * pi / 180
  long2 <- longitude.y * pi / 180
  lat2 <- latitude.y * pi / 180

  R <- 6371 # Earth mean radius in km

  a <- sin((lat2 - lat1) / 2)^2 + cos(lat1) * cos(lat2) * sin((long2 - long1) / 2)^2
  d <- R * 2 * asin(sqrt(a))

  return(round(d, round)) # distance in km
  
} 
dn_lq_tx <- dn_lq_tx %>% mutate(distance = haversine(longitude.x, latitude.x, longitude.y, latitude.y))

```

```{r mindennystx}
dn_lq_tx <- dn_lq_tx %>% group_by(address.x) %>% mutate(mindistance = min(distance, na.rm = FALSE)) %>% ungroup()

meandennys <- dn_lq_tx %>% 
  summarize(meandennys3 = mean(mindistance, na.rm = TRUE)) 

print(meandennys)

```

The mean distance of Dennys to the closest La Quinta is 5.79 km in Texas. 

### Exercise 10
```{r filterIL}
dn_il <- dennys %>%
  filter(state == "IL")
nrow(dn_il)

```

```{r filterquintaIL}
lq_il <- laquinta %>%
  filter(state == "IL")
nrow(lq_il)

```

```{r joindataIL}

dn_lq_il <- full_join(dn_il, lq_il,
  by = "state"
)
dn_lq_il

```

```{r calculatedistanceil}
haversine <- function(longitude.x, latitude.x, longitude.y, latitude.y, round = 3) {
  

  # convert to radians
  long1 <- longitude.x * pi / 180
  lat1 <- latitude.x * pi / 180
  long2 <- longitude.y * pi / 180
  lat2 <- latitude.y * pi / 180

  R <- 6371 # Earth mean radius in km

  a <- sin((lat2 - lat1) / 2)^2 + cos(lat1) * cos(lat2) * sin((long2 - long1) / 2)^2
  d <- R * 2 * asin(sqrt(a))

  return(round(d, round)) # distance in km
  
} 
dn_lq_il <- dn_lq_il %>% mutate(distance = haversine(longitude.x, latitude.x, longitude.y, latitude.y))

```

```{r mindennysil}
dn_lq_il <- dn_lq_il %>% group_by(address.x) %>% mutate(mindistance = min(distance, na.rm = FALSE)) %>% ungroup()

meandennys <- dn_lq_il %>% 
  summarize(meandennys4 = mean(mindistance, na.rm = TRUE)) 

print(meandennys)

```

The mean distance of Dennys to the closest La Quinta is 23.2 km in Illinois. 

###Conclusion

Out of all the analyses over Texas, North Carolina, Alaska, and Illinois I have come to the conclusion that Hedberg's joke holds true the most for Texas. Texas by far has the most observations of pairings of La Quinta and Dennys locations, and the resulting minimum distance after analysis is quite small between locations being 5.79km. 
